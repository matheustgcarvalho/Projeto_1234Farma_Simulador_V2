<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>1234Farma - Loja</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        :root { --tech-purple: #2E1A47; --neon-mint: #69FFC2; --pure-white: #FFFFFF; --warning-red: #ff4757; --alert-orange: #ff9800; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Roboto, Arial, sans-serif; user-select: none; }
        
        body { 
            background-color: var(--tech-purple); 
            color: var(--pure-white); 
            height: 100vh; 
            width: 100vw;
            display: flex; 
            flex-direction: column; 
            overflow: hidden; 
            font-size: 12px;
        }
        
        /* HEADER */
        header { 
            background-color: rgba(46, 26, 71, 0.95); 
            padding: 10px 15px; 
            display: grid; 
            grid-template-columns: 1fr auto 1fr;
            align-items: center; 
            border-bottom: 1px solid rgba(105, 255, 194, 0.3); flex-shrink: 0; 
        }

        .user-greeting { font-size: 1rem; font-weight: 700; color: rgba(255,255,255,0.9); justify-self: start; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 100%; }
        .brand-logo { font-size: 1.1rem; font-weight: 800; display: flex; align-items: center; gap: 5px; color: var(--pure-white); justify-self: center; }
        .brand-logo .material-icons { font-size: 1.3rem; color: var(--neon-mint); }
        .header-actions { display: flex; align-items: center; gap: 10px; justify-self: end; }

        .btn-pharmacist { background-color: var(--neon-mint); color: var(--tech-purple); width: 32px; height: 32px; border-radius: 50%; border: none; display: flex; justify-content: center; align-items: center; cursor: pointer; }
        .cart-icon-container { position: relative; text-decoration: none; color: white; display: flex; align-items: center;}
        .material-icons.md-36 { font-size: 26px; }
        .cart-badge { position: absolute; top: -5px; right: -8px; background-color: var(--warning-red); font-size: 0.6rem; padding: 2px 4px; border-radius: 10px; border: 1px solid var(--tech-purple); }

        /* BUSCA */
        .search-bar-wrapper { padding: 8px 10px; background-color: rgba(0,0,0,0.2); flex-shrink: 0; }
        
        .search-bar-container { position: relative; }
        
        .search-input { 
            width: 100%; padding: 8px 10px 8px 35px; border-radius: 20px; 
            border: 1px solid rgba(105, 255, 194, 0.5); 
            background-color: rgba(255,255,255,0.1); color: var(--pure-white); 
            font-size: 0.9rem; outline: none; 
            transition: all 0.3s;
            height: 35px; display: flex; align-items: center;
        }
        .search-input.active-input {
            border-color: var(--neon-mint);
            box-shadow: 0 0 10px rgba(105, 255, 194, 0.3);
            background-color: rgba(255,255,255,0.15);
        }

        .search-icon-span { position: absolute; left: 10px; top: 50%; transform: translateY(-50%); font-size: 1.1rem; color: var(--neon-mint); }

        /* CURSOR PISCANTE */
        @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }
        .cursor-bar {
            display: inline-block; width: 2px; height: 14px;
            background-color: var(--neon-mint);
            animation: blink 1s infinite;
            margin-left: 2px; vertical-align: middle;
            display: none;
        }

        /* CATEGORIAS */
        .category-scroll-container {
            display: flex; gap: 8px; overflow-x: auto; 
            padding: 10px; background-color: rgba(0,0,0,0.1);
            white-space: nowrap; flex-shrink: 0; scrollbar-width: none; 
        }
        .category-scroll-container::-webkit-scrollbar { display: none; }
        .category-chip {
            padding: 6px 12px; border-radius: 20px; 
            background-color: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1);
            color: rgba(255,255,255,0.8); font-size: 0.8rem; cursor: pointer;
            display: flex; align-items: center; gap: 5px; transition: 0.2s;
        }
        .category-chip.active { background-color: rgba(105, 255, 194, 0.2); border-color: var(--neon-mint); color: var(--neon-mint); font-weight: bold; }

        /* MAIN & GRID */
        main { flex-grow: 1; display: flex; flex-direction: column; overflow: hidden; width: 100%; position: relative; }
        
        .product-area { 
            flex-grow: 1; 
            padding: 10px; 
            overflow-y: auto; 
            padding-bottom: 80px; /* Padr√£o: Espa√ßo apenas para o footer */
            transition: padding-bottom 0.3s; /* Anima√ß√£o suave */
        }
        /* Classe ativada via JS quando o teclado abre */
        .product-area.keyboard-open {
            padding-bottom: 420px; /* Espa√ßo grande para o teclado */
        }

        .section-title { font-size: 1rem; margin-bottom: 10px; color: var(--neon-mint); font-weight: bold; padding-left: 5px; border-left: 3px solid var(--neon-mint); }
        
        .product-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; padding-bottom: 20px; }
        .product-card { background-color: rgba(255,255,255,0.05); border-radius: 10px; padding: 8px; display: flex; flex-direction: column; position: relative; min-height: 160px; border: 1px solid rgba(255,255,255,0.05); }
        .reg-tag { font-size: 0.5rem; padding: 2px 4px; border-radius: 4px; position: absolute; top: 6px; right: 6px; text-transform: uppercase; font-weight: bold;}
        .tag-otc { background-color: var(--neon-mint); color: var(--tech-purple); }
        
        .product-img-container { width: 100%; height: 60px; background-color: white; border-radius: 8px; margin-top: 15px; margin-bottom: 5px; display: flex; justify-content: center; align-items: center; }
        .product-img { max-width: 90%; max-height: 90%; object-fit: contain; }
        .product-title { font-size: 0.75rem; font-weight: 700; margin-bottom: 2px; line-height: 1.1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .product-subtitle { font-size: 0.6rem; color: rgba(255,255,255,0.6); margin-bottom: 5px; flex-grow: 1; line-height: 1; }
        .product-footer { display: flex; flex-direction: column; gap: 5px; margin-top: auto; }
        .footer-row { display: flex; justify-content: space-between; align-items: center; width: 100%; }
        .product-price { font-size: 0.85rem; font-weight: 700; color: var(--neon-mint); }
        
        .btn-add { width: 24px; height: 24px; border-radius: 50%; font-size: 1rem; display: flex; justify-content: center; align-items: center; border: 1px solid var(--neon-mint); background: transparent; color: var(--neon-mint); cursor: pointer; }
        .btn-add:active { background: var(--neon-mint); color: var(--tech-purple); }

        /* FOOTER */
        footer { background-color: rgba(46, 26, 71, 0.98); padding: 8px 15px; border-top: 1px solid rgba(105, 255, 194, 0.3); display: flex; justify-content: space-between; align-items: center; flex-shrink: 0; z-index: 50; }
        .footer-left-group { display: flex; align-items: center; gap: 15px; } 
        .btn-footer-exit { background: none; border: none; color: var(--warning-red); cursor: pointer; display: flex; align-items: center; gap: 4px; font-weight: 600; font-size: 0.75rem; padding: 5px; border-radius: 8px; transition: 0.2s; opacity: 0.8; }
        .btn-footer-exit:hover { opacity: 1; }
        .btn-footer-exit .material-icons { font-size: 1.1rem; }
        .cart-summary-text { font-size: 0.8rem; font-weight: 600; display: flex; align-items: center; gap: 5px; color: var(--pure-white); border-left: 1px solid rgba(255,255,255,0.2); padding-left: 15px; }
        .btn-checkout { background-color: var(--pure-white); color: var(--tech-purple); padding: 6px 15px; border-radius: 15px; font-weight: 800; border: none; font-size: 0.8rem; cursor: pointer; display: flex; align-items: center; gap: 5px; text-decoration: none;}

        /* TECLADO VIRTUAL */
        .virtual-keyboard {
            position: fixed; bottom: -400px; left: 0; width: 100%;
            background-color: #231438; border-top: 2px solid var(--neon-mint);
            padding: 8px; display: flex; flex-direction: column; gap: 5px;
            transition: bottom 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 2000; box-shadow: 0 -5px 20px rgba(0,0,0,0.5);
        }
        .virtual-keyboard.active { bottom: 0; }

        .kb-row { display: flex; justify-content: center; gap: 3px; width: 100%; }
        .kb-key {
            flex: 1; height: 42px;
            background-color: rgba(255,255,255,0.1); color: white;
            border: 1px solid rgba(255,255,255,0.2); border-radius: 5px;
            font-size: 1rem; font-weight: bold;
            cursor: pointer; display: flex; align-items: center; justify-content: center;
            max-width: 45px;
        }
        .kb-key:active { background-color: var(--neon-mint); color: var(--tech-purple); transform: scale(0.95); }
        .kb-key-wide { max-width: none; flex: 2; font-size: 0.85rem; text-transform: uppercase; }
        .kb-key-space { max-width: none; flex: 4; }
        .kb-key-backspace { background-color: rgba(255, 71, 87, 0.3); border-color: var(--warning-red); }
        .kb-key-close { background-color: rgba(105, 255, 194, 0.3); border-color: var(--neon-mint); color: var(--neon-mint); }

        /* MODAL */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.85); backdrop-filter: blur(3px); z-index: 3000; display: none; justify-content: center; align-items: center; }
        .modal-content { background-color: #2a1b3d; border: 1px solid var(--neon-mint); border-radius: 15px; padding: 25px; width: 85%; max-width: 350px; text-align: center; box-shadow: 0 0 30px rgba(0,0,0,0.5); animation: modalPop 0.3s ease-out; }
        @keyframes modalPop { 0% { transform: scale(0.8); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
        .modal-icon { font-size: 3.5rem; color: var(--alert-orange); margin-bottom: 15px; }
        .modal-title { font-size: 1.3rem; font-weight: 800; color: white; margin-bottom: 10px; }
        .modal-text { font-size: 1rem; color: rgba(255,255,255,0.7); margin-bottom: 25px; line-height: 1.4; }
        .modal-actions { display: flex; gap: 15px; }
        .modal-btn { flex: 1; padding: 12px; border-radius: 10px; border: none; font-weight: 700; cursor: pointer; font-size: 1rem;}
        .btn-modal-cancel { background-color: rgba(255,255,255,0.1); color: white; }
        .btn-modal-confirm { background-color: var(--alert-orange); color: white; }

    </style>
</head>
<body>

    <header>
        <div class="user-greeting">Ol√°, <span id="userNameDisplay">Visitante</span></div>
        <div class="brand-logo"><span class="material-icons">local_pharmacy</span> 1234Farma</div>
        <div class="header-actions">
            <button class="btn-pharmacist" onclick="window.location.href='ligacaofarmaceutico.html'" title="Farmac√™utico">
                <span class="material-icons">support_agent</span>
            </button>
            <a href="carrinho.html" class="cart-icon-container">
                <span class="material-icons md-36">shopping_cart</span>
                <span id="cartBadge" class="cart-badge">0</span>
            </a>
        </div>
    </header>
    
    <div class="search-bar-wrapper">
        <div class="search-bar-container">
            <span class="material-icons search-icon-span">search</span>
            <div class="search-input" id="searchTrigger">
                <span id="searchText">Toque para pesquisar...</span><span id="cursorBar" class="cursor-bar"></span>
            </div>
        </div>
    </div>

    <nav class="category-scroll-container">
        <div class="category-chip active" data-filter="all">üî• Todos</div>
        <div class="category-chip" data-filter="dor">üíä Dor e Febre</div>
        <div class="category-chip" data-filter="gripe">ü§ß Gripe</div>
        <div class="category-chip" data-filter="estomago">ü§¢ Digest√£o</div>
        <div class="category-chip" data-filter="socorros">ü©π Socorros</div>
        <div class="category-chip" data-filter="vitaminas">‚ö° Vitaminas</div>
    </nav>

    <main>
        <section class="product-area">
            <div class="section-title" id="sectionTitle">Populares</div>
            <div class="product-grid">
                <div class="product-card" data-category="dor"><span class="reg-tag tag-otc">Livre</span><div class="product-img-container"><img src="https://placehold.co/100x100/EEE/2E1A47?text=Dorflex" class="product-img"></div><h3 class="product-title">Dorflex Uno</h3><p class="product-subtitle">Dipirona 1g</p><div class="product-footer"><div class="footer-row"><span class="product-price">R$ 24,90</span><button class="btn-add" data-id="1" data-nome="Dorflex Uno" data-preco="24.90" data-imagem="https://placehold.co/100x100/EEE/2E1A47?text=Dorflex" data-rx="false">+</button></div></div></div>
                <div class="product-card" data-category="dor"><span class="reg-tag tag-otc">Livre</span><div class="product-img-container"><img src="https://placehold.co/100x100/EEE/2E1A47?text=Neosaldina" class="product-img"></div><h3 class="product-title">Neosaldina</h3><p class="product-subtitle">Enxaqueca</p><div class="product-footer"><div class="footer-row"><span class="product-price">R$ 19,50</span><button class="btn-add" data-id="2" data-nome="Neosaldina" data-preco="19.50" data-imagem="https://placehold.co/100x100/EEE/2E1A47?text=Neosaldina" data-rx="false">+</button></div></div></div>
                <div class="product-card" data-category="dor"><span class="reg-tag tag-otc">Livre</span><div class="product-img-container"><img src="https://placehold.co/100x100/EEE/2E1A47?text=Torsilax" class="product-img"></div><h3 class="product-title">Torsilax</h3><p class="product-subtitle">Relaxante</p><div class="product-footer"><div class="footer-row"><span class="product-price">R$ 17,90</span><button class="btn-add" data-id="3" data-nome="Torsilax" data-preco="17.90" data-imagem="https://placehold.co/100x100/EEE/2E1A47?text=Torsilax" data-rx="false">+</button></div></div></div>
                <div class="product-card" data-category="dor"><span class="reg-tag tag-otc">Livre</span><div class="product-img-container"><img src="https://placehold.co/100x100/EEE/2E1A47?text=Advil" class="product-img"></div><h3 class="product-title">Advil 400mg</h3><p class="product-subtitle">Ibuprofeno</p><div class="product-footer"><div class="footer-row"><span class="product-price">R$ 32,90</span><button class="btn-add" data-id="4" data-nome="Advil 400mg" data-preco="32.90" data-imagem="https://placehold.co/100x100/EEE/2E1A47?text=Advil" data-rx="false">+</button></div></div></div>
                <div class="product-card" data-category="dor"><span class="reg-tag tag-otc">Livre</span><div class="product-img-container"><img src="https://placehold.co/100x100/EEE/2E1A47?text=Paracetamol" class="product-img"></div><h3 class="product-title">Paracetamol</h3><p class="product-subtitle">750mg - 20cp</p><div class="product-footer"><div class="footer-row"><span class="product-price">R$ 8,50</span><button class="btn-add" data-id="5" data-nome="Paracetamol 750mg" data-preco="8.50" data-imagem="https://placehold.co/100x100/EEE/2E1A47?text=Paracetamol" data-rx="false">+</button></div></div></div>
                <div class="product-card" data-category="gripe"><span class="reg-tag tag-otc">Livre</span><div class="product-img-container"><img src="https://placehold.co/100x100/EEE/2E1A47?text=Benegrip" class="product-img"></div><h3 class="product-title">Benegrip</h3><p class="product-subtitle">Antigripal</p><div class="product-footer"><div class="footer-row"><span class="product-price">R$ 21,90</span><button class="btn-add" data-id="7" data-nome="Benegrip" data-preco="21.90" data-imagem="https://placehold.co/100x100/EEE/2E1A47?text=Benegrip" data-rx="false">+</button></div></div></div>
                <div class="product-card" data-category="gripe"><span class="reg-tag tag-otc">Livre</span><div class="product-img-container"><img src="https://placehold.co/100x100/EEE/2E1A47?text=Cimegripe" class="product-img"></div><h3 class="product-title">Cimegripe</h3><p class="product-subtitle">C√°psulas</p><div class="product-footer"><div class="footer-row"><span class="product-price">R$ 14,90</span><button class="btn-add" data-id="8" data-nome="Cimegripe" data-preco="14.90" data-imagem="https://placehold.co/100x100/EEE/2E1A47?text=Cimegripe" data-rx="false">+</button></div></div></div>
                <div class="product-card" data-category="gripe"><span class="reg-tag tag-otc">Livre</span><div class="product-img-container"><img src="https://placehold.co/100x100/EEE/2E1A47?text=Vick" class="product-img"></div><h3 class="product-title">Vick Vaporub</h3><p class="product-subtitle">Pomada</p><div class="product-footer"><div class="footer-row"><span class="product-price">R$ 25,00</span><button class="btn-add" data-id="9" data-nome="Vick Vaporub" data-preco="25.00" data-imagem="https://placehold.co/100x100/EEE/2E1A47?text=Vick" data-rx="false">+</button></div></div></div>
                <div class="product-card" data-category="gripe"><span class="reg-tag tag-otc">Livre</span><div class="product-img-container"><img src="https://placehold.co/100x100/EEE/2E1A47?text=Allegra" class="product-img"></div><h3 class="product-title">Allegra</h3><p class="product-subtitle">120mg</p><div class="product-footer"><div class="footer-row"><span class="product-price">R$ 65,90</span><button class="btn-add" data-id="12" data-nome="Allegra" data-preco="65.90" data-imagem="https://placehold.co/100x100/EEE/2E1A47?text=Allegra" data-rx="false">+</button></div></div></div>
                <div class="product-card" data-category="gripe"><span class="reg-tag tag-otc">Livre</span><div class="product-img-container"><img src="https://placehold.co/100x100/EEE/2E1A47?text=Polaramine" class="product-img"></div><h3 class="product-title">Polaramine</h3><p class="product-subtitle">Antial√©rgico</p><div class="product-footer"><div class="footer-row"><span class="product-price">R$ 15,90</span><button class="btn-add" data-id="13" data-nome="Polaramine" data-preco="15.90" data-imagem="https://placehold.co/100x100/EEE/2E1A47?text=Polaramine" data-rx="false">+</button></div></div></div>
                <div class="product-card" data-category="estomago"><span class="reg-tag tag-otc">Livre</span><div class="product-img-container"><img src="https://placehold.co/100x100/EEE/2E1A47?text=Eno" class="product-img"></div><h3 class="product-title">Eno Sach√™</h3><p class="product-subtitle">Sal de Frutas</p><div class="product-footer"><div class="footer-row"><span class="product-price">R$ 5,50</span><button class="btn-add" data-id="14" data-nome="Eno Sach√™" data-preco="5.50" data-imagem="https://placehold.co/100x100/EEE/2E1A47?text=Eno" data-rx="false">+</button></div></div></div>
                <div class="product-card" data-category="estomago"><span class="reg-tag tag-otc">Livre</span><div class="product-img-container"><img src="https://placehold.co/100x100/EEE/2E1A47?text=Epocler" class="product-img"></div><h3 class="product-title">Epocler</h3><p class="product-subtitle">Flaconete</p><div class="product-footer"><div class="footer-row"><span class="product-price">R$ 3,90</span><button class="btn-add" data-id="40" data-nome="Epocler" data-preco="3.90" data-imagem="https://placehold.co/100x100/EEE/2E1A47?text=Epocler" data-rx="false">+</button></div></div></div>
                <div class="product-card" data-category="estomago"><span class="reg-tag tag-otc">Livre</span><div class="product-img-container"><img src="https://placehold.co/100x100/EEE/2E1A47?text=Buscopan" class="product-img"></div><h3 class="product-title">Buscopan</h3><p class="product-subtitle">Composto</p><div class="product-footer"><div class="footer-row"><span class="product-price">R$ 22,00</span><button class="btn-add" data-id="15" data-nome="Buscopan" data-preco="22.00" data-imagem="https://placehold.co/100x100/EEE/2E1A47?text=Buscopan" data-rx="false">+</button></div></div></div>
                <div class="product-card" data-category="estomago"><span class="reg-tag tag-otc">Livre</span><div class="product-img-container"><img src="https://placehold.co/100x100/EEE/2E1A47?text=Omeprazol" class="product-img"></div><h3 class="product-title">Omeprazol</h3><p class="product-subtitle">20mg - 28cp</p><div class="product-footer"><div class="footer-row"><span class="product-price">R$ 28,00</span><button class="btn-add" data-id="16" data-nome="Omeprazol" data-preco="28.00" data-imagem="https://placehold.co/100x100/EEE/2E1A47?text=Omeprazol" data-rx="false">+</button></div></div></div>
                <div class="product-card" data-category="estomago"><span class="reg-tag tag-otc">Livre</span><div class="product-img-container"><img src="https://placehold.co/100x100/EEE/2E1A47?text=Luftal" class="product-img"></div><h3 class="product-title">Luftal</h3><p class="product-subtitle">Simeticona</p><div class="product-footer"><div class="footer-row"><span class="product-price">R$ 19,90</span><button class="btn-add" data-id="17" data-nome="Luftal" data-preco="19.90" data-imagem="https://placehold.co/100x100/EEE/2E1A47?text=Luftal" data-rx="false">+</button></div></div></div>
                <div class="product-card" data-category="socorros"><span class="reg-tag tag-otc">Livre</span><div class="product-img-container"><img src="https://placehold.co/100x100/EEE/2E1A47?text=Merthiolate" class="product-img"></div><h3 class="product-title">Merthiolate</h3><p class="product-subtitle">Spray 45ml</p><div class="product-footer"><div class="footer-row"><span class="product-price">R$ 25,90</span><button class="btn-add" data-id="50" data-nome="Merthiolate" data-preco="25.90" data-imagem="https://placehold.co/100x100/EEE/2E1A47?text=Merthiolate" data-rx="false">+</button></div></div></div>
                <div class="product-card" data-category="socorros"><span class="reg-tag tag-otc">Livre</span><div class="product-img-container"><img src="https://placehold.co/100x100/EEE/2E1A47?text=Nebacetin" class="product-img"></div><h3 class="product-title">Nebacetin</h3><p class="product-subtitle">Pomada 15g</p><div class="product-footer"><div class="footer-row"><span class="product-price">R$ 18,90</span><button class="btn-add" data-id="51" data-nome="Nebacetin" data-preco="18.90" data-imagem="https://placehold.co/100x100/EEE/2E1A47?text=Nebacetin" data-rx="false">+</button></div></div></div>
                <div class="product-card" data-category="socorros"><span class="reg-tag tag-otc">Livre</span><div class="product-img-container"><img src="https://placehold.co/100x100/EEE/2E1A47?text=Bandaid" class="product-img"></div><h3 class="product-title">Band-aid</h3><p class="product-subtitle">10 Unidades</p><div class="product-footer"><div class="footer-row"><span class="product-price">R$ 6,50</span><button class="btn-add" data-id="52" data-nome="Band-aid" data-preco="6.50" data-imagem="https://placehold.co/100x100/EEE/2E1A47?text=Bandaid" data-rx="false">+</button></div></div></div>
                <div class="product-card" data-category="vitaminas"><span class="reg-tag tag-otc">Livre</span><div class="product-img-container"><img src="https://placehold.co/100x100/EEE/2E1A47?text=Vit+C" class="product-img"></div><h3 class="product-title">Vitamina C</h3><p class="product-subtitle">Efervescente</p><div class="product-footer"><div class="footer-row"><span class="product-price">R$ 10,90</span><button class="btn-add" data-id="10" data-nome="Vitamina C" data-preco="10.90" data-imagem="https://placehold.co/100x100/EEE/2E1A47?text=Vit+C" data-rx="false">+</button></div></div></div>
                <div class="product-card" data-category="vitaminas"><span class="reg-tag tag-otc">Livre</span><div class="product-img-container"><img src="https://placehold.co/100x100/EEE/2E1A47?text=Centrum" class="product-img"></div><h3 class="product-title">Centrum</h3><p class="product-subtitle">A-Z</p><div class="product-footer"><div class="footer-row"><span class="product-price">R$ 80,00</span><button class="btn-add" data-id="26" data-nome="Centrum" data-preco="80.00" data-imagem="https://placehold.co/100x100/EEE/2E1A47?text=Centrum" data-rx="false">+</button></div></div></div>
            </div>
        </section>
    </main>

    <footer>
        <div class="footer-left-group">
            <button id="btnExit" class="btn-footer-exit" title="Sair do sistema">
                <span class="material-icons">logout</span> Sair
            </button>

            <div class="cart-summary-text">
                <span class="material-icons" style="font-size: 1rem;">shopping_bag</span> 
                <span id="footerCartCount">0 un</span>
            </div>
        </div>
        <a href="carrinho.html" class="btn-checkout">CARRINHO <span class="material-icons" style="font-size:0.9rem;">arrow_forward</span></a>
    </footer>

    <div id="virtualKeyboard" class="virtual-keyboard">
        <div class="kb-row">
            <button class="kb-key">1</button><button class="kb-key">2</button><button class="kb-key">3</button><button class="kb-key">4</button><button class="kb-key">5</button><button class="kb-key">6</button><button class="kb-key">7</button><button class="kb-key">8</button><button class="kb-key">9</button><button class="kb-key">0</button>
        </div>
        <div class="kb-row">
            <button class="kb-key">Q</button><button class="kb-key">W</button><button class="kb-key">E</button><button class="kb-key">R</button><button class="kb-key">T</button><button class="kb-key">Y</button><button class="kb-key">U</button><button class="kb-key">I</button><button class="kb-key">O</button><button class="kb-key">P</button>
        </div>
        <div class="kb-row">
            <button class="kb-key">A</button><button class="kb-key">S</button><button class="kb-key">D</button><button class="kb-key">F</button><button class="kb-key">G</button><button class="kb-key">H</button><button class="kb-key">J</button><button class="kb-key">K</button><button class="kb-key">L</button>
        </div>
        <div class="kb-row">
            <button class="kb-key">Z</button><button class="kb-key">X</button><button class="kb-key">C</button><button class="kb-key">V</button><button class="kb-key">B</button><button class="kb-key">N</button><button class="kb-key">M</button>
            <button class="kb-key kb-key-backspace"><span class="material-icons">backspace</span></button>
        </div>
        <div class="kb-row">
            <button class="kb-key kb-key-wide kb-key-close" id="kbCloseBtn">FECHAR</button>
            <button class="kb-key kb-key-space"> </button>
            <button class="kb-key kb-key-wide" style="background:var(--neon-mint);color:var(--tech-purple)">BUSCAR</button>
        </div>
    </div>

    <div id="qtyWarningModal" class="modal-overlay">
        <div class="modal-content modal-warning">
            <div class="material-icons modal-icon">health_and_safety</div>
            <div class="modal-title">Aten√ß√£o √† Sa√∫de</div>
            <div class="modal-text">
                Importante: O uso excessivo de qualquer medicamento sem a prescri√ß√£o de um profissional pode causar preju√≠zos √† sua sa√∫de.
                <br><br>
                <strong>Deseja continuar comprando mais de 3 unidades desse medicamento?</strong>
            </div>
            <div class="modal-actions">
                <button id="btnCancelQty" class="modal-btn btn-modal-cancel">N√£o</button>
                <button id="btnConfirmQty" class="modal-btn btn-modal-confirm">Sim, desejo</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const nomeSalvo = sessionStorage.getItem('usuarioFarmaFacil');
            if (nomeSalvo) {
                document.getElementById('userNameDisplay').textContent = nomeSalvo.split(' ')[0];
            }

            // BOT√ÉO SAIR
            document.getElementById('btnExit').addEventListener('click', function() {
                if(confirm("Deseja realmente sair?")) {
                    sessionStorage.removeItem('usuarioFarmaFacil');
                    window.location.href = 'login.html';
                }
            });

            let carrinho = JSON.parse(sessionStorage.getItem('carrinhoFarmaFacil')) || [];
            atualizarContadoresCarrinho();

            // TECLADO VIRTUAL L√ìGICA
            const searchTrigger = document.getElementById('searchTrigger');
            const searchText = document.getElementById('searchText');
            const cursorBar = document.getElementById('cursorBar');
            const keyboard = document.getElementById('virtualKeyboard');
            const kbKeys = document.querySelectorAll('.kb-key');
            const kbCloseBtn = document.getElementById('kbCloseBtn');
            const productCards = document.querySelectorAll('.product-card');
            const productArea = document.querySelector('.product-area'); // Para ajustar o padding

            let currentSearchTerm = "";

            // Abrir teclado
            searchTrigger.addEventListener('click', () => {
                keyboard.classList.add('active');
                searchTrigger.classList.add('active-input');
                cursorBar.style.display = 'inline-block'; 
                productArea.classList.add('keyboard-open'); // Ajusta padding
                if(currentSearchTerm === "") searchText.textContent = ""; 
            });

            function closeKeyboard() {
                keyboard.classList.remove('active');
                searchTrigger.classList.remove('active-input');
                cursorBar.style.display = 'none'; 
                productArea.classList.remove('keyboard-open'); // Reseta padding
                if(currentSearchTerm === "") searchText.textContent = "Toque para pesquisar...";
            }

            kbCloseBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                closeKeyboard();
            });

            // Digita√ß√£o
            kbKeys.forEach(key => {
                key.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const content = key.textContent.trim();
                    const isBackspace = key.classList.contains('kb-key-backspace') || key.querySelector('.material-icons');
                    const isSpace = key.classList.contains('kb-key-space');
                    const isSearch = content === 'BUSCAR';
                    const isClose = key.id === 'kbCloseBtn';

                    if (isClose) return;

                    if (isSearch) {
                        closeKeyboard();
                        return;
                    }

                    if (isBackspace) {
                        currentSearchTerm = currentSearchTerm.slice(0, -1);
                    } else if (isSpace) {
                        currentSearchTerm += " "; 
                    } else {
                        currentSearchTerm += content;
                    }

                    // Atualiza visual
                    searchText.textContent = currentSearchTerm;

                    // Aplica Filtro (usando startsWith para ordem exata)
                    const term = currentSearchTerm.toLowerCase();
                    productCards.forEach(card => {
                        const title = card.querySelector('.product-title').textContent.toLowerCase();
                        // L√ìGICA ALTERADA: 'startsWith' ao inv√©s de 'includes'
                        if (title.startsWith(term)) card.style.display = 'flex';
                        else card.style.display = 'none';
                    });
                });
            });

            // L√≥gica do Modal (Carrinho)
            const qtyWarningModal = document.getElementById('qtyWarningModal');
            const btnCancelQty = document.getElementById('btnCancelQty');
            const btnConfirmQty = document.getElementById('btnConfirmQty');
            let pendingProduct = null;

            btnCancelQty.addEventListener('click', () => {
                qtyWarningModal.style.display = 'none';
                pendingProduct = null;
            });

            btnConfirmQty.addEventListener('click', () => {
                if(pendingProduct) {
                    carrinho.push(pendingProduct);
                    sessionStorage.setItem('carrinhoFarmaFacil', JSON.stringify(carrinho));
                    atualizarContadoresCarrinho();
                }
                qtyWarningModal.style.display = 'none';
                pendingProduct = null;
            });


            // Filtros de Categoria
            const categoryChips = document.querySelectorAll('.category-chip');
            const sectionTitle = document.getElementById('sectionTitle');

            categoryChips.forEach(chip => {
                chip.addEventListener('click', function() {
                    categoryChips.forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                    const filter = this.getAttribute('data-filter');
                    
                    sectionTitle.textContent = this.textContent.trim().substring(2);

                    productCards.forEach(card => {
                        if (filter === 'all' || card.getAttribute('data-category') === filter) card.style.display = 'flex';
                        else card.style.display = 'none';
                    });
                });
            });

            // Adicionar ao Carrinho
            document.querySelectorAll('.btn-add').forEach(button => {
                button.addEventListener('click', function() {
                    const isRx = this.getAttribute('data-rx') === 'true';
                    if (isRx) {
                        alert("‚ö†Ô∏è Requer Receita!\nChame o farmac√™utico.");
                    } else {
                        const id = this.getAttribute('data-id');
                        const qtdAtual = carrinho.filter(item => item.id === id).length;

                        const produto = {
                            id: id,
                            nome: this.getAttribute('data-nome'),
                            preco: parseFloat(this.getAttribute('data-preco')),
                            imagem: this.getAttribute('data-imagem')
                        };

                        if (qtdAtual >= 3) {
                            pendingProduct = produto;
                            qtyWarningModal.style.display = 'flex';
                        } else {
                            carrinho.push(produto);
                            sessionStorage.setItem('carrinhoFarmaFacil', JSON.stringify(carrinho));
                            atualizarContadoresCarrinho();
                            
                            const originalHtml = this.innerHTML;
                            this.innerHTML = '<span class="material-icons" style="font-size:1rem;">check</span>';
                            this.style.backgroundColor = 'var(--neon-mint)';
                            this.style.color = 'var(--tech-purple)';
                            setTimeout(() => { 
                                this.innerHTML = originalHtml; 
                                this.style.backgroundColor = 'transparent';
                                this.style.color = 'var(--neon-mint)';
                            }, 500);
                        }
                    }
                });
            });

            function atualizarContadoresCarrinho() {
                const count = carrinho.length;
                document.getElementById('cartBadge').textContent = count;
                document.getElementById('footerCartCount').textContent = count + ' un';
            }
        });
    </script>
</body>
</html>